<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ€ãƒ¼</title>
    <style>
  /* ==========================
     ğŸŒ¸ ãƒšãƒ¼ã‚¸å…¨ä½“ã®è¨­å®š
     ========================== */
  body {
    font-family: "Noto Sans JP", sans-serif; /* â† å…¨ä½“ã®ãƒ•ã‚©ãƒ³ãƒˆï¼ˆã“ã“ã‚’å¤‰ãˆã‚‹ã¨å…¨ä½“ãŒå¤‰ã‚ã‚‹ï¼‰ */
    background: #eef3f7;  /* ãƒšãƒ¼ã‚¸å…¨ä½“ã®èƒŒæ™¯è‰² */
    color: #333;          /* å…¨ä½“ã®æ–‡å­—è‰² */
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;    /* é«˜ã•ã‚’ç”»é¢å…¨ä½“ã«åˆã‚ã›ã‚‹ */
    font-size: 35px;      /* â† â˜…å…¨ä½“ã®åŸºæœ¬ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆã“ã“ã‚’å¤§ããã™ã‚‹ã¨å…¨ä½“ãŒæ¯”ä¾‹ã—ã¦æ‹¡å¤§ï¼‰ */
  }

  /* ==========================
     ğŸŸ¦ ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆä¸Šéƒ¨ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ï¼‰
     ========================== */
  header {
    width: 100%;                  /* ç”»é¢å¹…ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
    background: linear-gradient(135deg, #00b4db, #0083b0); /* ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
    color: white;                 /* æ–‡å­—è‰² */
    text-align: center;           /* ä¸­å¤®æƒãˆ */
    padding: 1.2rem;              /* â† ä¸Šä¸‹ã®ä½™ç™½ï¼ˆremå˜ä½ï¼šãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºåŸºæº–ï¼‰ */
    font-size: 2rem;              /* â† â˜…ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—ã®å¤§ãã•ï¼ˆå¤§ããã—ãŸã„ãªã‚‰ã“ã“ï¼‰ */
    font-weight: 700;             /* å¤ªå­— */
    letter-spacing: 0.05em;       /* æ–‡å­—é–“éš”å°‘ã—åºƒã‚ */
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); /* å½± */
  }

  /* ==========================
     ğŸŸ© ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ï¼ˆä¸­å¤®ã®ç™½ã„éƒ¨åˆ†ï¼‰
     ========================== */
  main {
    flex: 1;
    width: 98%;                   /* â† ç”»é¢å¹…ã®ä½•ï¼…ã‚’ä½¿ã†ã‹ï¼ˆç‹­ã„ã¨æ€ã£ãŸã‚‰98%ã¨ã‹ã«ï¼‰ */
    max-width: 650px;             /* â† æœ€å¤§å¹…ï¼ˆã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã§åºƒãŒã‚Šã™ãé˜²æ­¢ï¼‰ */
    background: white;
    border-radius: 20px;          /* â† ã‚«ãƒ¼ãƒ‰ã®è§’ä¸¸åŠå¾„ï¼ˆæ•°å­—ã‚’å¤§ããâ†’ä¸¸ã¿å¼·ãï¼‰ */
    margin-top: 1rem;             /* â† ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã®é–“ã®ä½™ç™½ */
    padding: 2rem 1.5rem;         /* â† å†…å´ä½™ç™½ï¼ˆä¸Šä¸‹ãƒ»å·¦å³ï¼‰ */
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); /* ã‚«ãƒ¼ãƒ‰å½± */
    text-align: center;
  }

  /* ==========================
     ğŸŸ¨ ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ï¼ˆåˆ—ãƒ»ç•ªå·ï¼‰
     ========================== */
  select {
    width: 90%;                   /* â† æ¨ªå¹…ï¼ˆç”»é¢å…¨ä½“ã«åºƒã’ãŸã„å ´åˆã¯ 90% ãªã©ã«ï¼‰ */
    font-size: 1.3rem;            /* â† â˜…ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³å†…æ–‡å­—ã®å¤§ãã• */
    padding: 12px;                /* â† å†…å´ã®ä½™ç™½ï¼ˆä¸Šä¸‹ãƒ»å·¦å³ï¼‰ */
    margin: 0.8rem;               /* â† è¦ç´ é–“ã®é–“éš” */
    border: 2px solid #ccc;       /* æ ç·š */
    border-radius: 8px;           /* è§’ã®ä¸¸ã¿ */
    background: #f8f8f8;
  }

  /* ==========================
     ğŸ“· æ’®å½±ãƒœã‚¿ãƒ³
     ========================== */
  #cameraInput {
    display: none; /* inputè‡ªä½“ã¯éš ã—ã¦labelã‚’ãƒœã‚¿ãƒ³ä»£ã‚ã‚Šã«ä½¿ã† */
  }

  label.camera-button {
    display: inline-block;
    background: #0083b0;          /* â† ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰² */
    color: white;                 /* ãƒœã‚¿ãƒ³æ–‡å­—ã®è‰² */
    font-size: 1.6rem;            /* â† â˜…ãƒœã‚¿ãƒ³ã®æ–‡å­—ã‚µã‚¤ã‚ºï¼ˆå¤§ããã—ãŸã„ãªã‚‰ã“ã“ï¼‰ */
    padding: 1rem 3rem;           /* â† ãƒœã‚¿ãƒ³ã®é«˜ã•ãƒ»å¹…ã‚’æ±ºã‚ã‚‹ï¼ˆä¸Šä¸‹ãƒ»å·¦å³ï¼‰ */
    margin-top: 1.8rem;           /* ãƒœã‚¿ãƒ³ä¸Šã®ä½™ç™½ */
    border-radius: 50px;          /* â† ä¸¸ã¿ã®å¼·ã•ï¼ˆå¤§ãã„ã»ã©ä¸¸ï¼‰ */
    cursor: pointer;              /* ã‚¯ãƒªãƒƒã‚¯ã‚«ãƒ¼ã‚½ãƒ« */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25); /* å½± */
    transition: background 0.3s, transform 0.1s;
  }

  label.camera-button:hover {
    background: #00b4db;          /* â† ãƒ›ãƒãƒ¼ï¼ˆæŠ¼ã—ãŸæ™‚ï¼‰ã®è‰² */
    transform: scale(1.05);       /* â† æŠ¼ã—ãŸæ™‚ã«å°‘ã—æ‹¡å¤§ï¼ˆæ¼”å‡ºï¼‰ */
  }

  /* ==========================
     ğŸ’¬ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ãƒ»å®Œäº†ãªã©ï¼‰
     ========================== */
  #status {
    margin-top: 1.5rem;
    font-size: 1.2rem;            /* â† â˜…ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†ã®æ–‡å­—ã‚µã‚¤ã‚º */
    line-height: 1.6;             /* è¡Œé–“ï¼ˆè¦‹ã‚„ã™ãã™ã‚‹ï¼‰ */
    word-wrap: break-word;        /* é•·ã„æ–‡å­—åˆ—ã‚’æŠ˜ã‚Šè¿”ã™ */
  }

  /* ç‚¹æ»…ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
  .loading {
    animation: blink 1s infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  /* ==========================
     ğŸŸ« ãƒ•ãƒƒã‚¿ãƒ¼
     ========================== */
  footer {
    margin-top: auto;
    font-size: 1rem;              /* â† ãƒ•ãƒƒã‚¿ãƒ¼æ–‡å­—ã‚µã‚¤ã‚º */
    color: #777;
    padding: 1rem 0;
  }
</style>

  </head>

  <body>
    <header>ğŸ“¸ å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ€ãƒ¼</header>

    <main>
      <div>
        <label>åˆ—ï¼š</label>
        <select id="column">
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>

        <label>ç•ªå·ï¼š</label>
        <select id="number">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
      </div>

      <input type="file" accept="image/*" capture="camera" id="cameraInput">
      <label for="cameraInput" class="camera-button">ğŸ“· æ’®å½±ã™ã‚‹</label>

      <p id="status"></p>
    </main>

    <footer>Â© 2025 å±‹å°éƒ¨ Photo Upload System</footer>

    <script>
      const input = document.getElementById('cameraInput');
      const status = document.getElementById('status');

      input.addEventListener('change', () => {
        const file = input.files[0];
        if (!file) return;

        const column = document.getElementById('column').value;
        const number = document.getElementById('number').value;

        const reader = new FileReader();

        reader.onloadend = () => {
          status.innerText = 'ğŸ“¤ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...';
          status.classList.add('loading');

          google.script.run
            .withSuccessHandler(msg => {
              status.innerHTML = `âœ… <b>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†:</b><br>${msg}`;
              status.classList.remove('loading');
            })
            .withFailureHandler(err => {
              status.innerText = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + JSON.stringify(err);
              status.classList.remove('loading');
            })
            .uploadFile(reader.result, column, number);
        };

        reader.readAsDataURL(file);
      });
    </script>
  </body>
</html>
